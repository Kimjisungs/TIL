## 실행 컨텍스트

[실행 컨텍스트] : 자바스크립트 엔진이 관리하는 객체
컨텍스트는 문맥.
식별자가 값을 할당하면 실행 컨텍스트에 등록됨. 자바스크립트 엔진은
스코프를 어떻게 등록하는가. 어떻게 올라가고, 왜 내려가지는 않는가.
호이스팅은 왜 발생하는가

~~~javascript
function foo(){

}
foo();

//함수가 호출되면 위로가서 안으로 들어가는 이유
/* 
	현재 실행중인 코드가 어떻게 아는가.
*/
~~~



## 실행 가능한 코드

| 실행 가능한 코드         | 설명                                                         |
| :----------------------- | :----------------------------------------------------------- |
| 전역 코드(Global code)   | 전역에 존재하는 텍스트 코드를 말한다. 전역에 정의된 함수, 클래스 등의 내부 코드는 포함되지 않는다. |
| 함수 코드(Function code) | 함수 내부에 존재하는 텍스트 코드를 말한다. 함수 내부에 중첩된 함수, 클래스 등의 내부 코드는 포함되지 않는다. |
| eval 코드(Eval code)     | 빌트인 전역 함수인 eval 함수에 인수로 전달된 텍스트 코드를 말한다. |
| 모듈 코드(Module code)   | 모듈 내부에 존재하는 텍스트 코드를 말한다. 모듈 내부의 함수, 클래스 등의 내부 코드는 포함되지 않는다. |

eval, with는 안쓴느것이기 때문에 주목하지 않아도된다. 독자적인 스코프를 만든다.

webpack으로 인위적인 파일 스코프를 만든다. iife로 인위적으로 파일스코프 비스무리하게 만든다. 



### 전역코드, 함수코드 주목!!

전역코드 : 전역에 존재하는 코드. 전역함수 내부에 코드불럭은 지역이다. 

함수코드 : 함수코드블럭 내부, 중첩된 함수는 



전역코드, 함수코드, eval 코드. 모듈코드 등 실행 가능한 코드들은 **실행 컨텍스트** 를 만든다.

코드가 평가되면 식별자가 생성된다. 식별자는 실행 컨텍스트에 등록한다. 평과 결과를.. 식별자가 있으면 값이 있어야한다.  평가가 끝났을때 실행 컨텍스트에 저장. 그리고 실행 결과로 넘어간다. 

~~~javascript
var x = 1;

var x;
x = 1; 
//자바스크립트는 두개의 문으로 본다.
//평가단계에서는 x = undefiend;
//실행단계에서는 x = 1;
~~~

1.코드가 평과되면

식별자 값이 실행컨텍스트

코드가 실행되고 식별자를 참조해야한다.

참조를 실행컨텍스트에서 참조한다

실행 컨텍스트는 실행에 필요한 정보를 담고있다. 



20191022_실행컨텍스트 2 녹음 시작

~~~javascript
console.log() // 코드의 실행 단계에서 실행 
// 전역 변수 선언
const x = 1; //얘는 우리가볼때 하나지만 두개로 평가.
const y = 2; // 실행될때 값 2로 초기화됨.

// 함수 정의
function foo(a) {
  // 지역 변수 선언
  const x = 10;
  const y = 20;

  // 메소드 호출
  console.log(a + x + y); // 130
}

// 함수 호출
foo(100);

// 메소드 호출
console.log(x + y); // 3
~~~

var는 선언과 초기화가 한번에 이루어짐

const,let 선언단계와 초기화 단계가 분리되어짐. 초기화하여 무엇인가 채움. let,const 호이스팅 안되는것같이 하지만 호이스팅한다. 코드가 실행되기 이전에 식별자를 심는다.

평가단계에서 x = 언이니셜라이즈드.

평가단계에서 function foo = function foo

전역코드에서는 함수 내부를 들여다 보지 않는다. 

초기화는 변수에 처음으로 값을 넣는것. x = 1

스코프는 실행 순서를 관리하는데, 실행컨텍스트 스택이라는 자료구조로 관리된다.

## 실행 컨텍스트 스택

~~~javascript
const x = 1; 

function foo () {
  const y = 2;

  function bar () {
    const z = 3;
    console.log(x + y + z);
  }
  bar();
}

foo(); // 6
~~~

실행 컨텍스트 스택으로 현재 실행이무엇인지 어디로 돌아가야 하는지 알 수 있다.

## 동기식 처리 모델과 비동기식 처리 모델

자바스크립트 엔진은 실행컨텍스트 스택이 한번에 하나 있다. 만약 두개있다면 그것을 멀티 스레드이라고한다. 하지만 자바스크립트는 하나만 있다. 이것을 싱글 스레드라고한다. 자바스크립트는 싱글 스레드이다.

비동기 코드는 가독성이 나빠지고 콜백 방식을 사용해야 한다.  콜백을 해결하기 위해 promise가 나옴.  성공하면 부를 함수와 실패하면 부를함수. 

## 렉시컬 환경

자바스크립트의 모든 스코프는 렉시컬 스코프

식별자가 a스코프에 있냐 b스코프에잇냐. 식별자가 선언되는 환경을 말한다.

실행 컨텍스트라는 자료구조가 렉시컬환경으로 이루어져있다.

스코프 체인은, 렉시컬스코프의 연결이다. 

실행 컨텍스트와 렉시컬의 환경. 실행컨텍스트는 두개의 프로퍼티(컨포넌트)를 갖는다.

1.  렉시컬인바이러먼트
2. 베리어블인바이러먼트

태어나자마자 렉시컬환경을 둘다 가르키고 있다. 실체는 렉시컬이다. 식별자 들이 들어온다. 실행컨텍스트는 렉시컬환경이라는 것을 가지고 있다. 

렉시컬 환경도 3개의 프로퍼티(컴포넌트)를 가지고 있다.

[[Lexical envirnment]]

environmentRecord 이것이 상위 스코프를 가르킴, 상위 렉시컬 스코프를 가르킴

thisBinding에는 this값이 들어온다.

~~~javascript
var x = 1;
const y = 2;

function foo (a) {
  var x = 3;
  const y = 4;

  function bar (b) {
    const z = 5;
    console.log(a + b + x + y + z);
}
  bar(10);
}

foo(20); // 42

/* 
	1. 전역 코드의 평가. 맨위 var x = 1, const y = 2, 환경 레코드에 등록
	2. 실행 컨텍스트, 렉시컬환경, 환경 레코드 알아야함
*/
~~~



 변수는 현재 실행중인 실행 컨텍스트에서부터 찾는다. 실행 컨텍스트의 최상위, 현재 실행컨텍트스에서 부터 찾는다.

바 함수가 실행종료되면 excution context만 없어짐. 실행 컨텍스트만 없어지고 lexical enviroment, function envirement record 는 누가 쳐다보고 있다면 살아있다.  전역 변수는 전역 객체와 생명주기가 일치한다. 